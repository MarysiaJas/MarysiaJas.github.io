<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Szczeg贸y dla Goci - Marysia i Ja</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; margin: 0; background-color: #f9f9f9; color: #333; }
        header { background-color: #f0f0f0; padding: 20px 0; text-align: center; border-bottom: 1px solid #ddd; }
        nav a { margin: 0 15px; text-decoration: none; color: #333; font-weight: bold; }
        main { max-width: 800px; margin: 30px auto; padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        h1, h2, h3 { color: #444; text-align: center; }
        h2 { border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 40px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], textarea, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { display: block; width: 100%; padding: 12px; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; transition: background-color 0.2s; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        #guest-form button { background-color: #28a745; }
        #guest-form button:hover { background-color: #218838; }
        #decline-form button { background-color: #dc3545; }
        #decline-form button:hover { background-color: #c82333; }
        .form-response { text-align: center; padding: 15px; margin-top: 20px; border-radius: 4px; display: none; }
        .form-response.success { background-color: #d4edda; color: #155724; }
        .form-response.error { background-color: #f8d7da; color: #721c24; }
        #plota-list { list-style-type: none; padding: 0; }
        #plota-list li { background-color: #f8f9fa; padding: 10px; border-radius: 4px; margin-bottom: 8px; text-align: center; font-size: 1.1em; }
    </style>
</head>
<body>

    <header>
        <h1>Marysia i Ja</h1>
        <nav>
            <a href="index.html">Strona G贸wna</a>
            <a href="szczegoly.html">Szczeg贸y dla goci weselnych</a>
        </nav>
    </header>

    <main>
        <h2>Przydatne Informacje</h2>
        <h3>Koci贸</h3>
        <p>Koci贸 jest dosy adny. Powinno spokojnie wystarczy miejsc dla wszystkich. Jest ogrzewany, wic nie powinno by bardzo zimno. Parking jest przed kocioem oraz drugi, bardzo du偶y, za nim, po objechaniu go g贸wn ulic.</p>
        <h3>Sala Weselna</h3>
        <p>Rezydencja Mietowe Wzg贸rza jest niedaleko lotniska Modlin, porodku niczego. </p>
        <h3>Dojazd do sali i powr贸t</h3>
        <p>Oferujemy wszystkim transport do sali spod kocioa po lubie. Bdzie te偶 jecha autobus z Widzowa, jeli zbierze si chetna grupa os贸b. Wszyscy jadcy z Widzowa maj zapewniony nocelg na miejscu i powr贸t do Widzowa rano po niadaniu. 
        Wszyscy, kt贸rzy chc wr贸ci do Warszawy bd mieli tak mo偶liwo korzystajac z dw贸ch autobus贸w, o p贸nocy oraz po zakoczeniu wesela, okoo 2:00 lub 3:00 w nocy</p>
        <h3>Noclegi</h3>
        <p>Rodzinie z daleka proponujemy nocleg na miejscu, lub w pobliskich hotelach, do kt贸rych zawiezie Was kursujcy samoch贸d.</p>
        
        <h2>Plota: Kto ju偶 potwierdzi? </h2>
        <ul id="plota-list">
            <li>adowanie listy goci...</li>
        </ul>

        <h2>Potwierd藕 swoj obecno</h2>
        <p>Je偶eli bdziesz z nami w tym dniu, prosimy o wypenienie poni偶szego formularza.</p>
        <form id="guest-form">
            <input type="hidden" name="submissionType" value="confirm">
            <div class="form-group">
                <label for="nazwisko">Nazwisko:</label>
                <input type="text" id="nazwisko" name="Nazwisko" required placeholder="np. Kowalscy">
            </div>
            <div class="form-group">
                <label for="imiona">Imiona goci:</label>
                <input type="text" id="imiona" name="ImionaGosci" required placeholder="np. Anna, Jan (oddzielone przecinkiem)">
            </div>
            <div class="form-group">
                <label for="nocleg">Nocleg:</label>
                <select id="nocleg" name="Nocleg"><option value="Nie dotyczy">Prosz wybra...</option><option value="Nie, dzikujemy">Nie, dzikujemy</option><option value="Tak, prosimy o rezerwacj">Tak, prosimy o rezerwacj</option></select>
            </div>
            <div class="form-group">
                <label for="dieta">Informacje o diecie:</label>
                <textarea id="dieta" name="Dieta" rows="3" placeholder="np. wegetariaska, alergie"></textarea>
            </div>
            <div class="form-group">
                <label for="transport-dojazd">Dojazd na wesele:</label>
                <select id="transport-dojazd" name="TransportDojazd"><option value="Brak">Brak / Dojazd wasny</option><option value="Autobus z Widzowa">Autobus z Widzowa</option><option value="Autobus spod kocioa">Autobus spod kocioa</option></select>
            </div>
            <div class="form-group">
                <label for="transport-powrot">Powr贸t z wesela:</label>
                <select id="transport-powrot" name="TransportPowrot"><option value="Brak">Brak / Powr贸t wasny</option><option value="Autobus do Widzowa">Autobus do Widzowa</option><option value="Autobus do centrum Warszawy">Autobus do centrum Warszawy</option></select>
            </div>
            <button type="submit">Tak, bdziemy!</button>
        </form>
        <div id="response-confirm" class="form-response"></div>
        
        <h2>Nie mo偶esz by z nami?</h2>
        <p>Z przykroci przyjmujemy t wiadomo. Daj nam zna, wypeniajc poni偶sze pola, abymy mogli zaktualizowa list.</p>
        <form id="decline-form">
             <input type="hidden" name="submissionType" value="decline">
             <div class="form-group">
                <label for="nazwisko-decline">Nazwisko:</label>
                <input type="text" id="nazwisko-decline" name="Nazwisko" required>
            </div>
            <div class="form-group">
                <label for="imiona-decline">Imiona goci:</label>
                <input type="text" id="imiona-decline" name="ImionaGosci" required>
            </div>
            <button type="submit">Niestety, nie damy rady</button>
        </form>
        <div id="response-decline" class="form-response"></div>

    </main>

    <script>
        // UWAGA! Wklej tutaj URL swojej aplikacji webowej z Google Apps Script
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw-y1_Yxl4sqePM-IFXMYqmaKen7Hqe44ZSglsPWvrLG1gkk9BnnPfl4p5wBE-qIibF/exec";

        const plotaList = document.getElementById('plota-list');
        const confirmForm = document.getElementById('guest-form');
        const declineForm = document.getElementById('decline-form');
        const responseConfirmDiv = document.getElementById('response-confirm');
        const responseDeclineDiv = document.getElementById('response-decline');

        // --- 1. Funkcja do adowania listy "Plota" przy starcie strony ---
        function loadGuestList() {
            fetch(SCRIPT_URL)
                .then(response => response.json())
                .then(data => {
                    if (data.result === 'success' && data.data.length > 0) {
                        plotaList.innerHTML = ''; // Wyczy "adowanie..."
                        data.data.forEach(guest => {
                            const li = document.createElement('li');
                            li.textContent = `${guest.surname} (${guest.count} ${guest.count > 1 ? 'osoby' : 'osoba'})`;
                            plotaList.appendChild(li);
                        });
                    } else if (data.result === 'success') {
                        plotaList.innerHTML = '<li>Na razie nikt si nie wpisa. Bd藕 pierwszy/a!</li>';
                    } else {
                         plotaList.innerHTML = '<li>Nie udao si zaadowa listy.</li>';
                    }
                })
                .catch(error => {
                    console.error('Bd adowania listy goci:', error);
                    plotaList.innerHTML = '<li>Wystpi bd podczas adowania listy.</li>';
                });
        }
        
        // --- 2. Funkcja do obsugi wysyania formularzy ---
        function handleFormSubmit(form, responseDiv) {
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const submitButton = form.querySelector('button');
                submitButton.disabled = true;
                submitButton.textContent = 'Przetwarzanie...';

                fetch(SCRIPT_URL, { method: 'POST', body: new FormData(form) })
                    .then(response => response.json())
                    .then(data => {
                        if (data.result === 'success') {
                            responseDiv.textContent = 'Dzikujemy! Twoja odpowied藕 zostaa zapisana.';
                            responseDiv.className = 'form-response success';
                            form.reset();
                            loadGuestList(); // Odwie偶 list "Plota"
                        } else {
                            throw new Error(data.message || 'Nieznany bd');
                        }
                    })
                    .catch(error => {
                        console.error('Bd wysyania formularza:', error);
                        responseDiv.textContent = 'Wystpi bd. Spr贸buj ponownie. ' + error.message;
                        responseDiv.className = 'form-response error';
                    })
                    .finally(() => {
                        submitButton.disabled = false;
                        // Przywr贸 oryginalny tekst przycisku
                        if(form.id === 'guest-form') submitButton.textContent = 'Tak, bdziemy!';
                        if(form.id === 'decline-form') submitButton.textContent = 'Niestety, nie damy rady';
                        responseDiv.style.display = 'block';
                    });
            });
        }

        // --- 3. Uruchomienie funkcji ---
        document.addEventListener('DOMContentLoaded', loadGuestList);
        handleFormSubmit(confirmForm, responseConfirmDiv);
        handleFormSubmit(declineForm, responseDeclineDiv);
    </script>
</body>
</html>
